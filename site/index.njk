---
layout: base.njk
title: Family Tree
---
{% from "person-tree.njk" import renderPerson %}

<header class="royal-header">
  <div class="royal-crown">â™›</div>
  <h1>Family Tree</h1>
  <p class="royal-subtitle">Generated with Eleventy</p>
  <p class="tree-source">Source folder: <code>{{ familyTree.sourceDir }}</code></p>

  <div class="controls">
    <button id="expand-all" type="button" aria-label="Expand all family branches">Expand All</button>
    <button id="collapse-all" type="button" aria-label="Collapse all family branches except the root">Collapse All</button>
  </div>
</header>

<main>
  <p id="a11y-status" class="sr-only" role="status" aria-live="polite" aria-atomic="true"></p>

  {% if familyTree.error %}
    <div class="build-error">
      <h2>Build Input Error</h2>
      <p>{{ familyTree.error }}</p>
      <p>Set <code>FAMILY_DATA_DIR</code> to a valid folder path.</p>
    </div>
  {% elseif not familyTree.root %}
    <div class="build-error">
      <h2>No root person found</h2>
      <p>Check person markdown files and `_marriage.md` references.</p>
    </div>
  {% else %}
    <ul class="family-tree">
      {{ renderPerson(familyTree.root, 0) }}
    </ul>
  {% endif %}

  <div class="details-overlay" id="details-overlay" hidden>
    <div class="details-dialog" id="details-dialog" role="dialog" aria-modal="true" aria-labelledby="details-name" aria-describedby="details-context" tabindex="-1">
      <p id="details-context" class="sr-only">Details dialog. Press Escape to close. Tab stays inside the dialog.</p>
      <button class="details-close" id="details-close" aria-label="Close details dialog">âœ•</button>

      <div class="details-avatar-wrap">
        <div class="details-avatar" id="details-avatar"></div>
      </div>

      <h2 class="details-name" id="details-name"></h2>
      <div class="details-spouses" id="details-spouses"></div>

      <div class="details-meta">
        <div class="details-meta-row">
          <span class="details-meta-icon">ğŸ“…</span>
          <span class="details-meta-label">Born</span>
          <span class="details-meta-value details-placeholder" id="details-born">â€”</span>
        </div>
        <div class="details-meta-row">
          <span class="details-meta-icon">ğŸ“…</span>
          <span class="details-meta-label">Died</span>
          <span class="details-meta-value details-placeholder" id="details-died">â€”</span>
        </div>
        <div class="details-meta-row">
          <span class="details-meta-icon">ğŸ‘¥</span>
          <span class="details-meta-label">People</span>
          <span class="details-meta-value">{{ familyTree.totalPeople }}</span>
        </div>
        <div class="details-meta-row details-meta-row--small">
          <span class="details-meta-icon">ğŸ–¼ï¸</span>
          <span class="details-meta-label">Photo fallback</span>
          <span class="details-meta-value">{{ familyTree.imageFallbackOrder | join(', ') }}</span>
        </div>
      </div>

      <section class="details-bio" aria-label="Biography">
        <h3 class="details-bio-title">Biography</h3>
        <div class="details-bio-content" id="details-bio-content">
          <p class="details-placeholder">No biography text provided.</p>
        </div>
      </section>
    </div>
  </div>
</main>
